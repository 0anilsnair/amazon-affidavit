import{j as t,r,l as N,a as P,c as _,d as j,g as R,H as J,M as K,F as Q,b as T,e as M,u as F,f as H}from"./index-BFBCywcg.js";const O=({isOpen:u,onClose:d,children:h,className:m})=>{if(!u)return null;const y=f=>{f.target===f.currentTarget&&d()};return t.jsx("div",{className:"modal-backdrop",onClick:y,children:t.jsx("div",{className:`${m||""} modal-content`,children:h})})},U=({modalOpen:u,closeModal:d,handleAddProduct:h,addProduct:m,data:y,types:f})=>{const[c,E]=r.useState({name:"",description:"",link:"",timestamp:"",category:""});r.useEffect(()=>{E(y||{name:"",description:"",link:"",timestamp:"",image:"",category:""})},[y]);const l=o=>{const{name:x,value:p}=o.target;E(g=>({...g,[x]:p}))};return t.jsxs(O,{isOpen:u,onClose:d,children:[t.jsx("h2",{children:c?.id?"Edit Product":"Add New Product"}),t.jsxs("form",{className:"add-product-form",onSubmit:o=>o?.preventDefault()&&h(c),noValidate:!0,children:[t.jsx("input",{type:"text",name:"name",placeholder:"Product Name *",value:c.name,onChange:l,required:!0,autoFocus:!0}),t.jsx("textarea",{name:"description",placeholder:"Description",value:c.description,onChange:l}),t.jsx("input",{type:"url",name:"link",placeholder:"Product Link *",value:c.link,onChange:l,required:!0}),t.jsx("input",{type:"url",name:"image",placeholder:"Image Link *",value:c.image,onChange:l,required:!0}),t.jsxs("select",{name:"category",value:c.category,onChange:l,required:!0,children:[t.jsx("option",{value:"",children:"Select Product Type *"}),f?.sort((o,x)=>o?.order-x?.order)?.map(o=>t.jsx("option",{value:o?.name,children:o?.name}))]}),t.jsxs("div",{className:"modal-buttons",children:[t.jsx("button",{type:"submit",className:"submit-btn",onClick:()=>m(c),children:c?.id?"Save Product":"Add Product"}),t.jsx("button",{type:"button",className:"cancel-btn",onClick:d,children:"Cancel"})]})]})]})},W=({isOpen:u,onClose:d,onConfirm:h,itemName:m="this item"})=>t.jsx(O,{isOpen:u,onClose:d,children:t.jsxs("div",{className:"delete-modal",children:[t.jsx("h2",{children:"Confirm Deletion"}),t.jsxs("p",{children:["Are you sure you want to delete ",t.jsx("strong",{children:m}),"?"]}),t.jsxs("div",{className:"delete-modal__buttons",children:[t.jsx("button",{className:"btn cancel",onClick:d,children:"Cancel"}),t.jsx("button",{className:"btn confirm",onClick:h,children:"Delete"})]})]})}),X=({modalOpen:u,closeModal:d,addCategoryEvent:h,types:m,deleteCategory:y})=>{const f=r.useRef(null),[c,E]=r.useState({order:"",name:"",icon:""}),[l,o]=r.useState(),[x,p]=r.useState([]);r.useEffect(()=>{o(),p(m||[])},[m]);const g=(a,n)=>{const{name:C,value:v}=a.target;o(k=>({...k,[C]:v})),p(k=>k?.map(D=>D?.id===n?.id?{...D,[C]:v}:D))},b=()=>{const a=f.current;if(a&&(a.scrollTop=0),x?.some(n=>n?.id==="new-product")){alert("Product adding in process");return}o({order:"",name:"",icon:"",id:"new-product"}),p(n=>[{order:"",name:"",icon:"",id:"new-product"},...n])},L=()=>{p(m),o()},S=()=>{const a=x?.find(C=>C?.id===l?.id);console.log(a);let n={...a,order:Number(a?.order)};a?.id==="new-product"&&delete n.id,h(n)};return t.jsxs(O,{className:"category-modal",isOpen:u,onClose:d,children:[t.jsx("h2",{children:"Category List"}),t.jsxs("form",{className:"add-category-form",noValidate:!0,onSubmit:a=>a?.preventDefault(),children:[t.jsx("div",{className:"type-list-wrapper",ref:f,children:x?.map(a=>t.jsxs("div",{className:"input-wrapper",children:[t.jsx("input",{type:"text",name:"order",placeholder:"Order",value:a.order,disabled:a?.id!==l?.id,onChange:n=>g(n,a),required:!0}),t.jsx("input",{type:"text",name:"name",placeholder:"Name",value:a.name,disabled:a?.id!==l?.id,onChange:n=>g(n,a),required:!0}),t.jsx("input",{type:"text",name:"icon",placeholder:"Icon",value:a.icon,disabled:a?.id!==l?.id,onChange:n=>g(n,a),required:!0}),a?.id===l?.id?t.jsxs(t.Fragment,{children:[t.jsx("button",{type:"button",className:"cancel-btn",onClick:()=>L(),title:"Cancel",children:t.jsx("i",{className:"fas fa-ban"})}),t.jsx("button",{type:"button",className:"submit-btn",onClick:()=>S(),title:"Save",children:t.jsx("i",{className:"fa fa-plus"})})]}):t.jsxs(t.Fragment,{children:[t.jsx("button",{type:"button",className:"submit-btn",onClick:()=>o(a),title:"Edit",children:t.jsx("i",{className:"fas fa-edit"})}),t.jsx("button",{type:"button",className:"delete-btn",onClick:()=>y(a),title:"Delete",children:t.jsx("i",{className:"fas fa-trash"})})]})]}))}),t.jsxs("div",{className:"modal-buttons",children:[t.jsx("button",{type:"submit",className:"submit-btn",onClick:()=>b(),children:"Add Category"}),t.jsx("button",{type:"button",className:"cancel-btn",onClick:d,children:"Cancel"})]})]})]})};function Z(){const[u,d]=r.useState([]),[h,m]=r.useState([]),[y,f]=r.useState(""),[c,E]=r.useState("All"),l=u.filter(s=>{const i=s.name?.toLowerCase().includes(y?.toLowerCase())||s.description?.toLowerCase().includes(y?.toLowerCase()),w=c==="All"||s.category===c;return i&&w}),o=["All",...new Set(u.map(s=>s.category))],[x,p]=r.useState(!1),[g,b]=r.useState(),[L,S]=r.useState(!1),[a,n]=r.useState(!1);r.useEffect(()=>{C(),v(),N(P,"page_view",{page:"Admin Page"})},[]);const C=async()=>{try{const s=_(j,"products"),w=(await R(s)).docs.map(A=>({id:A.id,...A.data()}));d(w)}catch(s){console.error("Error fetching products:",s)}},v=async()=>{try{const s=_(j,"types"),w=(await R(s)).docs.map(A=>({id:A.id,...A.data()}));m(w)}catch(s){console.error("Error fetching Categories:",s)}},k=()=>{b(),p(!0)},D=()=>{b(),n(!0)},I=s=>{if(e.preventDefault(),!s.name.trim()||!s.link.trim()|!s.category.trim()){alert("Please enter mandatory fields");return}const i={id:u.length+1,...s};d(w=>[...w,i]),closeModal()},q=async s=>{try{if(!s.name.trim()||!s.link.trim()|!s.category.trim()){alert("Please enter mandatory fields");return}if(s?.id){const i=M(j,"products",s?.id);await F(i,{...s,timestamp:new Date}),N(P,"add_shipping_info",{action:"Edit Product"})}else{const i=await T(_(j,"products"),{...s,timestamp:new Date});N(P,"add_to_cart",{action:"Add Product"})}b(),p(!1),await C()}catch(i){console.error("Error adding product: ",i)}},V=s=>{b(s),p(!0)},B=s=>{S(!0),b(s)},$=async()=>{const s=M(j,"products",g?.id);await H(s),S(!1),await C(),N(P,"remove_from_cart",{action:"Delete Product"})},z=async s=>{if(console.log(s),!s?.id)await T(_(j,"types"),{...s,timestamp:new Date}),N(P,"add_to_wishlist",{action:"Add Category"}),await v();else{const i=M(j,"types",s?.id);await F(i,{...s,timestamp:new Date}),N(P,"add_to_wishlist",{action:"Edit Category"}),await v()}},G=async s=>{const i=M(j,"types",s?.id);await H(i),S(!1),await v(),N(P,"remove_from_cart",{action:"Delete Category"})};return t.jsxs("div",{children:[t.jsx(U,{modalOpen:x,data:g,types:h,closeModal:()=>p(!1),handleAddProduct:I,addProduct:q}),t.jsx(X,{modalOpen:a,data:g,types:h,closeModal:()=>n(!1),addCategoryEvent:z,addProduct:q,deleteCategory:G}),t.jsx(W,{isOpen:L,onClose:()=>S(!1),onConfirm:$,itemName:g?.name}),t.jsxs("div",{className:"app-container",children:[t.jsx(J,{isAdmin:!0,addProductEvent:k,addCategoryEvent:D}),t.jsx(K,{isAdmin:!0,products:l,searchTerm:y,setSearchTerm:f,categories:o,activeCategory:c,setActiveCategory:E,deleteEvent:s=>B(s),editEvent:s=>V(s)}),t.jsx(Q,{})]})]})}export{Z as Component};
